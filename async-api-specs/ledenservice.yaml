asyncapi: 2.4.0
info:
  title: Rapportage Service
  version: '1.0.0'
  description: "Service voor het registreren, wijzigen en verwijderen van leden."
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0

servers:
  local-kafka:
    url: kafka://localhost:9093
    protocol: kafka

channels:
  event.leden:
    subscribe:
      bindings:
        kafka:
          groupId: ledenservice
      operationId: ledenActie
      summary: 'Kanaal waarop de berichten m.b.t. de leden worden verstuurd.'
      message:
        oneOf:
          - $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop-demo/async-api-specs/gebeurtenissen/LidAangemeld.yaml#/components/messages/LidAangemeld'
          - $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop-demo/async-api-specs/gebeurtenissen/LidGewijzigd.yaml#/components/messages/LidGewijzigd'
          - $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop-demo/async-api-specs/gebeurtenissen/LidVerwijderd.yaml#/components/messages/LidVerwijderd'

# Voorbeeld van subscribe actie, de generator voegt automatisch een bericht toe die hij op de
# kafka-bus plaatst in de application.java
#    subscribe:
#      operationId: lidGewijzigd
#      message:
#        $ref: '#/components/messages/lidGewijzigdSubscribe'
#
#components:
#  messages:
#    lidAangemeld:
#      messageId: "LidAangemeld"
#      name: "LidAangemeld"
#      summary: Informeer over het lid dat is aangemeld
#      schemaFormat: "application/vnd.apache.avro+json;version=1.9.0"
#      payload:
#        $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop/models/Lid.avsc'
#
#    lidGewijzigd:
#      messageId: "LidGewijzigd"
#      summary: Informeer over het gewijzigde lid
#      schemaFormat: "application/vnd.apache.avro+json;version=1.9.0"
#      payload:
#        $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop/models/Lid.avsc'
#
#    lidGewijzigdSubscribe:
#      messageId: "LidGewijzigdSubscribe"
#      summary: Ontvangen bericht over het gewijzigde lid
#      schemaFormat: "application/vnd.apache.avro+json;version=1.9.0"
#      payload:
#        $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop/models/Lid.avsc'
#
#    lidVerwijderd:
#      messageId: "LidVerwijderd"
#      summary: Informeer over welk lid verwijderd is
#      schemaFormat: application/schema+json;version=draft-07
#      payload:
#        type: object
#        $id: LidVerwijderdPayload
#        properties:
#          id:
#            type: string
#            format: uuid
#            description: 'Unieke identificatie van het lid te verwijderen.'
#          verzondenOp:
#            type: object
#            $ref: 'https://raw.githubusercontent.com/Feature-Branch-BV/ASyncApi-Bibliotheek-Schemas/develop/models/VerzondenOp.json'
#        required:
#          - id
#          - verzondenOp
